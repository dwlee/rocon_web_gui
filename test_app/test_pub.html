<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="css/bootstrap.css" rel="stylesheet"></link>
    <link href="css/bootstrap-button.css" rel="stylesheet"></link>
    
    <script src="js/jquery.js"></script>
    <script src="js/bootstrap/bootstrap.js"></script>
    <script src="js/bootstrap/bootstrap-button.js"></script>
    <script src="js/eventemitter2/eventemitter2.js"></script>
    <script src="js/ros/roslib.js"></script>
    
    <style type="text/css">
      body {
        padding-top: 60px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }

      @media (max-width: 980px) {
        /* Enable use of floated navbar text */
        .navbar-text.pull-right {
          float: none;
          padding-left: 5px;
          padding-right: 5px;
        }
      }
    </style>
    <link href="css/bootstrap-responsive.css" rel="stylesheet"></link>
    
    <script type="text/javascript">
      
      var chatter_pub_topic = "/chatter";
      var chatter_pub_type = "std_msgs/String"

      var defaultUrL = 'ws://localhost:9090';
      var ros = new ROSLIB.Ros();
      var chatter_publisher;
      var cnt = 0;
      $().ready(function(e){
        // setting ros callbacks()
        settingROSCallbacks();
        ros.connect(defaultUrL);
      });

      function settingROSCallbacks(){
        ros.on('connection',function() {
          console.log("Connected");
          // subscribe to order list
          chatter_publisher = new ROSLIB.Topic({
              ros : ros,
              name : chatter_pub_topic,
              messageType : chatter_pub_type
          });
          $(".chatter-pub").click(function(data){
            console.log("chatter pub");
            cnt = cnt+1         
            var text = new ROSLIB.Message({
              data: "chatter chatter: " + cnt
            });
            console.log(text);
            console.log(chatter_publisher);
            chatter_publisher.publish(text);
            console.log("publishing");
          })
          console.log(ros);
        })
      };
    </script>
  </head>
  <body>
    <h1>Pub Test</h1>
    <button class="chatter-pub">Chatter</button></p>
    <hr/>

  </body>
</html>

